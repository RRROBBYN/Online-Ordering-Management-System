@rendermode InteractiveServer
@inject Components.Service.CartService CartService
@implements IDisposable

<button class="cart-btn" @onclick="ToggleCart">
    <i class="gg-shopping-cart"></i>
    <span>Cart</span>
    @if (CartService.ItemCount > 0)
    {
        <span class="cart-badge">@CartService.ItemCount</span>
    }
</button>

<style>
    .cart-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #0284c7;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: bold;
    }

    .cart-btn {
        position: relative;
    }
</style>

@code {
    protected override void OnInitialized()
    {
        CartService.OnCartChanged += StateHasChanged;
    }

    private void ToggleCart()
    {
        CartService.ToggleCart();
    }

    public void Dispose()
    {
        CartService.OnCartChanged -= StateHasChanged;
    }
}
